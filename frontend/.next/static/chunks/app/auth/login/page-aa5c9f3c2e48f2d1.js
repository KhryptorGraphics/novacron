(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6716],{62898:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const o=(e,t)=>{const r=(0,n.forwardRef)((({color:r="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:i,children:c,...u},d)=>{return(0,n.createElement)("svg",{ref:d,...s,width:o,height:o,stroke:r,strokeWidth:i?24*Number(a)/Number(o):a,className:`lucide lucide-${l=e,l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,...u},[...t.map((([e,t])=>(0,n.createElement)(e,t))),...(Array.isArray(c)?c:[c])||[]]);var l}));return r.displayName=`${e}`,r}},11981:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},73067:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},68291:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},22812:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},28203:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},20173:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},13008:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},62442:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]])},81291:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("ChevronLeft",[["polyline",{points:"15 18 9 12 15 6",key:"kvxz59"}]])},17158:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("ChevronRight",[["polyline",{points:"9 18 15 12 9 6",key:"1rtp27"}]])},6141:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},77216:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},99670:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},74056:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},86264:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5589:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1295:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},12741:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},36678:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},49036:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]])},92851:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},67972:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},25750:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},82104:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},82549:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(62898).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},68637:function(e,t,r){Promise.resolve().then(r.bind(r,47217))},47217:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v},dynamic:function(){return g}});var n=r(57437),s=r(2265),o=r(24033),a=r(3089),i=r(86582),c=r(6429),u=r(10609),d=r(59404),l=r(87258),h=r(61396),f=r.n(h),m=r(16746),p=r(50471);function y(e){let{tempToken:t,onSuccess:r,onCancel:o}=e;const[h,f]=(0,s.useState)(""),[m,y]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null),[x,k]=(0,s.useState)(!1),{toast:w}=(0,d.p)();return(0,n.jsxs)(u.Zb,{className:"w-full max-w-md",children:[(0,n.jsxs)(u.Ol,{className:"text-center",children:[(0,n.jsxs)(u.ll,{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)(l.P.shield,{className:"h-5 w-5 text-blue-600"}),"Two-Factor Authentication"]}),(0,n.jsx)(u.SZ,{children:x?"Enter one of your backup codes to continue":"Enter the 6-digit code from your authenticator app"})]}),(0,n.jsx)(u.aY,{children:(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!h||h.length<6)v(x?"Please enter your backup code":"Please enter the 6-digit code from your authenticator app");else{y(!0),v(null);try{const e=await p.O.verify2FALogin({user_id:"",code:h,is_backup_code:x,temp_token:t});if(!e.token)throw new Error("Authentication failed");p.O.setToken(e.token,e.user),p.O.removeTempToken(),w({title:"Login Successful",description:"You have been authenticated successfully."}),r(e.token)}catch(g){console.error("2FA login verification failed:",g);const t=g instanceof Error?g.message:"Invalid code. Please try again.";v(t)}finally{y(!1)}}},className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c._,{htmlFor:"code",children:x?"Backup Code":"Verification Code"}),(0,n.jsx)(i.I,{id:"code",type:"text",inputMode:x?"text":"numeric",pattern:x?void 0:"[0-9]*",maxLength:x?12:6,placeholder:x?"xxxx-xxxx":"123456",value:h,onChange:e=>{const t=x?e.target.value:e.target.value.replace(/\D/g,"");f(t)},className:g?"border-red-500":"",autoComplete:"one-time-code",disabled:m}),g&&(0,n.jsx)("p",{className:"text-sm text-red-600",children:g})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(a.z,{type:"submit",disabled:m||!x&&6!==h.length||x&&0===h.length,className:"flex-1",children:m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.P.spinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.P.checkCircle2,{className:"mr-2 h-4 w-4"}),"Verify"]})}),(0,n.jsx)(a.z,{type:"button",onClick:()=>{p.O.removeTempToken(),o()},variant:"outline",disabled:m,children:"Cancel"})]}),(0,n.jsxs)("div",{className:"text-center space-y-2",children:[(0,n.jsx)(a.z,{type:"button",onClick:()=>{k(!x),f(""),v(null)},variant:"ghost",className:"text-sm text-gray-500",disabled:m,children:x?"Use authenticator code instead":"Use backup code"}),(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,n.jsx)("p",{children:"Can't access your authenticator app?"}),(0,n.jsx)("p",{children:"Use one of your backup codes to sign in."})]})]})]})})]})}const g="force-dynamic";function v(){const e=(0,o.useRouter)(),{toast:t}=(0,d.p)(),[r,h]=(0,s.useState)(!1),[p,g]=(0,s.useState)(""),[v,x]=(0,s.useState)(""),{login:k,verify2FA:w,requires2FA:b,tempToken:N}=(0,m.useAuth)();const Z=r=>{t({title:"Success",description:"You have been logged in successfully."}),e.push("/dashboard")},j=()=>{g(""),x("")};return b&&N?(0,n.jsx)("div",{className:"container flex h-screen w-screen flex-col items-center justify-center",children:(0,n.jsx)(y,{tempToken:N,onSuccess:Z,onCancel:j})}):(0,n.jsx)("div",{className:"container flex h-screen w-screen flex-col items-center justify-center",children:(0,n.jsxs)(u.Zb,{className:"w-full max-w-md",children:[(0,n.jsxs)(u.Ol,{className:"space-y-1",children:[(0,n.jsx)(u.ll,{className:"text-2xl text-center",children:"Login"}),(0,n.jsx)(u.SZ,{className:"text-center",children:"Enter your email and password to access your account"})]}),(0,n.jsx)(u.aY,{className:"grid gap-4",children:(0,n.jsxs)("form",{onSubmit:async function(r){r.preventDefault(),h(!0);try{await k(p,v),b||(t({title:"Success",description:"You have been logged in successfully."}),e.push("/dashboard"))}catch(n){console.error("Login error:",n),t({title:"Error",description:"Invalid email or password. Please try again.",variant:"destructive"})}finally{h(!1)}},children:[(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(c._,{htmlFor:"email",children:"Email"}),(0,n.jsx)(i.I,{id:"email",placeholder:"name@example.com",type:"email",autoCapitalize:"none",autoComplete:"email",autoCorrect:"off",disabled:r,value:p,onChange:e=>g(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"grid gap-2 mt-4",children:[(0,n.jsx)(c._,{htmlFor:"password",children:"Password"}),(0,n.jsx)(i.I,{id:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",type:"password",autoComplete:"current-password",disabled:r,value:v,onChange:e=>x(e.target.value),required:!0})]}),(0,n.jsxs)(a.z,{className:"w-full mt-6",type:"submit",disabled:r,children:[r&&(0,n.jsx)(l.P.spinner,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign In"]})]})}),(0,n.jsxs)(u.eW,{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"text-sm text-muted-foreground text-center",children:(0,n.jsx)(f(),{href:"/auth/forgot-password",className:"hover:text-brand underline underline-offset-4",children:"Forgot your password?"})}),(0,n.jsxs)("div",{className:"text-sm text-muted-foreground text-center mt-2",children:["Don't have an account?"," ",(0,n.jsx)(f(),{href:"/auth/register",className:"hover:text-brand underline underline-offset-4",children:"Sign up"})]})]})]})})}},3089:function(e,t,r){"use strict";r.d(t,{z:function(){return u}});var n=r(57437),s=r(2265),o=r(67256),a=r(96061),i=r(60345);const c=(0,a.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm hover:shadow-md",success:"bg-success text-success-foreground hover:bg-success/90 shadow-sm hover:shadow-md",warning:"bg-warning text-warning-foreground hover:bg-warning/90 shadow-sm hover:shadow-md",info:"bg-info text-info-foreground hover:bg-info/90 shadow-sm hover:shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-accent-foreground/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground hover:scale-105",link:"text-primary underline-offset-4 hover:underline hover:text-primary/80",nova:"bg-gradient-to-r from-nova-500 to-nova-600 text-white hover:from-nova-600 hover:to-nova-700 shadow-md hover:shadow-lg"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef(((e,t)=>{let{className:r,variant:s,size:a,asChild:u=!1,...d}=e;const l=u?o.g7:"button";return(0,n.jsx)(l,{className:(0,i.cn)(c({variant:s,size:a,className:r})),ref:t,...d})}));u.displayName="Button"},10609:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return u},Zb:function(){return a},aY:function(){return d},eW:function(){return l},ll:function(){return c}});var n=r(57437),s=r(2265),o=r(60345);const a=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})}));a.displayName="Card";const i=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})}));i.displayName="CardHeader";const c=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})}));c.displayName="CardTitle";const u=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})}));u.displayName="CardDescription";const d=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...s})}));d.displayName="CardContent";const l=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})}));l.displayName="CardFooter"},87258:function(e,t,r){"use strict";r.d(t,{P:function(){return _}});var n=r(86264),s=r(81291),o=r(17158),a=r(62442),i=r(82549),c=r(11981),u=r(74056),d=r(13008),l=r(82104),h=r(99670),f=r(77216),m=r(49036),p=r(36678),y=r(5589),g=r(1295),v=r(67972),x=r(25750),k=r(12741),w=r(22812),b=r(73067),N=r(68291),Z=r(20173),j=r(28203),T=r(6141),S=r(92851);const _={spinner:n.Z,chevronLeft:s.Z,chevronRight:o.Z,check:a.Z,cross:i.Z,warning:c.Z,info:u.Z,success:d.Z,error:l.Z,eye:h.Z,eyeOff:f.Z,shield:m.Z,shieldCheck:p.Z,lock:y.Z,mail:g.Z,user:v.Z,users:x.Z,phone:k.Z,building:w.Z,arrowLeft:b.Z,arrowRight:N.Z,checkCircle2:Z.Z,calendar:j.Z,clock:T.Z,sparkles:S.Z}},86582:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var n=r(57437),s=r(2265),o=r(60345);const a=s.forwardRef(((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})}));a.displayName="Input"},6429:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var n=r(57437),s=r(2265),o=r(36743),a=r(96061),i=r(60345);const c=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=s.forwardRef(((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(o.f,{ref:t,className:(0,i.cn)(c(),r),...s})}));u.displayName=o.f.displayName},59404:function(e,t,r){"use strict";r.d(t,{p:function(){return o}});var n=r(57437),s=r(5925);function o(){return{toast:e=>{const{title:t,description:r,variant:o="default",duration:a=4e3}=e,i=(0,n.jsxs)("div",{className:"grid gap-1",children:[t&&(0,n.jsx)("div",{className:"text-sm font-semibold",children:t}),r&&(0,n.jsx)("div",{className:"text-sm opacity-90",children:r})]});"destructive"===o?s.toast.error(i,{duration:a}):s.toast.success(i,{duration:a})}}}},16746:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return c},useAuth:function(){return u}});var n=r(57437),s=r(2265),o=r(24033),a=r(50471);const i=(0,s.createContext)(void 0);function c(e){let{children:t}=e;const[r,c]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),[l,h]=(0,s.useState)(!1),[f,m]=(0,s.useState)(null),p=(0,o.useRouter)();(0,s.useEffect)((()=>{const e=a.O.getToken(),t=a.O.getTempToken();if(e){const e=a.O.getCurrentUser();c(e)}else t&&(m(t),h(!0));d(!1)}),[]);return(0,n.jsx)(i.Provider,{value:{user:r,isLoading:u,isAuthenticated:!!r,requires2FA:l,tempToken:f,login:async(e,t)=>{try{const r=await a.O.login({email:e,password:t});r.requires_2fa&&r.temp_token?(a.O.setTempToken(r.temp_token),m(r.temp_token),h(!0)):(a.O.setToken(r.token,r.user),c(r.user),h(!1),m(null))}catch(r){throw console.error("Login failed:",r),r}},logout:()=>{a.O.logout(),c(null),h(!1),m(null),p.push("/auth/login")},verify2FA:async e=>{if(!f)throw new Error("No temporary token available");try{const t=await a.O.verify2FALogin({code:e,temp_token:f});a.O.setToken(t.token,t.user),a.O.removeTempToken(),c(t.user),h(!1),m(null)}catch(t){throw console.error("2FA verification failed:",t),t}}},children:t})}function u(){const e=(0,s.useContext)(i);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},50471:function(e,t,r){"use strict";r.d(t,{O:function(){return s}});const n=r(59792).env.NEXT_PUBLIC_API_URL||"http://localhost:8090";const s=new class{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="".concat(n).concat(e),s={headers:{"Content-Type":"application/json",...t.headers},...t};try{const e=await fetch(r,s);if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(o){throw console.error("API request failed for ".concat(e,":"),o),o}}async login(e){return this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)})}async register(e){return this.request("/api/auth/register",{method:"POST",body:JSON.stringify(e)})}async forgotPassword(e){return this.request("/api/auth/forgot-password",{method:"POST",body:JSON.stringify(e)})}async resetPassword(e){return this.request("/api/auth/reset-password",{method:"POST",body:JSON.stringify(e)})}decodeJWT(e){try{const t=e.split(".");if(3!==t.length)throw new Error("Invalid JWT format");const r=t[1],n=atob(r.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(n)}catch(t){return console.error("Failed to decode JWT:",t),null}}getCurrentUser(){const e=this.getToken();if(!e)return null;try{const t=this.decodeJWT(e);if(!t)return this.removeToken(),null;if(t.exp&&1e3*t.exp<Date.now())return this.removeToken(),null;const r={id:t.sub||t.user_id||t.id,email:t.email||"",firstName:t.firstName||t.first_name||t.given_name||"",lastName:t.lastName||t.last_name||t.family_name||"",tenantId:t.tenantId||t.tenant_id,status:t.status||"active",two_factor_enabled:t.two_factor_enabled||t["2fa_enabled"]||!1};return localStorage.setItem("authUser",JSON.stringify(r)),r}catch(t){return console.error("Error getting current user:",t),this.removeToken(),null}}isAuthenticated(){return!!this.getToken()}getToken(){return localStorage.getItem("novacron_token")}setToken(e,t){localStorage.setItem("novacron_token",e),t&&localStorage.setItem("authUser",JSON.stringify(t))}removeToken(){localStorage.removeItem("novacron_token"),localStorage.removeItem("authUser"),localStorage.removeItem("tempToken")}logout(){this.removeToken()}async setup2FA(){const e=this.getToken(),t=this.getCurrentUser();if(!t)throw new Error("User not authenticated");return this.request("/api/auth/2fa/setup",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:JSON.stringify({user_id:t.id,account_name:t.email})})}async verify2FASetup(e){const t=this.getToken(),r=this.getCurrentUser();if(!r&&!e.user_id)throw new Error("User ID required for 2FA verification");return this.request("/api/auth/2fa/verify",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({user_id:e.user_id||(null===r||void 0===r?void 0:r.id),code:e.code,is_backup_code:e.is_backup_code||!1})})}async verify2FALogin(e){return this.request("/api/auth/2fa/verify-login",{method:"POST",body:JSON.stringify({user_id:e.user_id,code:e.code,is_backup_code:e.is_backup_code||!1,temp_token:e.temp_token})})}async enable2FA(e){const t=this.getCurrentUser();if(!t)throw new Error("User not authenticated");const r=this.getToken();return this.request("/api/auth/2fa/enable",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({user_id:t.id,code:e})})}async disable2FA(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const t=this.getToken();return this.request("/api/auth/2fa/disable",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({user_id:e.id})})}async get2FAStatus(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const t=this.getToken(),r=await this.request("/api/auth/2fa/status?user_id="+e.id,{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});return{enabled:r.enabled,backup_codes_remaining:0,setup:r.setup,setup_at:r.setup_at,last_used:r.last_used}}async generateBackupCodes(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const t=this.getToken();return this.request("/api/auth/2fa/backup-codes",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({user_id:e.id})})}setTempToken(e){localStorage.setItem("tempToken",e)}getTempToken(){return localStorage.getItem("tempToken")}removeTempToken(){localStorage.removeItem("tempToken")}}},60345:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var n=r(50348),s=r(23986);function o(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m)((0,n.W)(t))}},24033:function(e,t,r){e.exports=r(50094)},59792:function(e){var t=e.exports={},r=[],n=!1;function s(){if(!n){var e;n=!0;for(var t=r.length;t;){e=r,r=[];for(var s=-1;++s<t;)e[s]();t=r.length}n=!1}}function o(){}t.nextTick=function(e){r.push(e),n||setTimeout(s,0)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=o,t.addListener=o,t.once=o,t.off=o,t.removeListener=o,t.removeAllListeners=o,t.emit=o,t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},36743:function(e,t,r){"use strict";r.d(t,{f:function(){return i}});var n=r(2265),s=r(9381),o=r(57437),a=n.forwardRef(((e,t)=>(0,o.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}})));a.displayName="Label";var i=a},9381:function(e,t,r){"use strict";r.d(t,{WV:function(){return i},jH:function(){return c}});var n=r(2265),s=r(54887),o=r(67256),a=r(57437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce(((e,t)=>{const r=(0,o.Z8)(`Primitive.${t}`),s=n.forwardRef(((e,n)=>{const{asChild:s,...o}=e,i=s?r:t;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(i,{...o,ref:n})}));return s.displayName=`Primitive.${t}`,{...e,[t]:s}}),{});function c(e,t){e&&s.flushSync((()=>e.dispatchEvent(t)))}}},function(e){e.O(0,[2649,6892,2971,2472,1744],(function(){return t=68637,e(e.s=t);var t}));var t=e.O();_N_E=t}]);