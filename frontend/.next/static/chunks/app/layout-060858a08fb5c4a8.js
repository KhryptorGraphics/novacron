(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{39067:function(e,r,t){Promise.resolve().then(t.bind(t,29932)),Promise.resolve().then(t.bind(t,5925)),Promise.resolve().then(t.t.bind(t,92489,23)),Promise.resolve().then(t.bind(t,58325)),Promise.resolve().then(t.bind(t,60688)),Promise.resolve().then(t.bind(t,23570)),Promise.resolve().then(t.bind(t,16746)),Promise.resolve().then(t.bind(t,61003))},58325:function(e,r,t){"use strict";t.r(r),t.d(r,{AsyncErrorBoundary:function(){return f},ErrorBoundary:function(){return m},NetworkError:function(){return g},NotFoundError:function(){return x},PermissionError:function(){return v}});var s=t(57437),n=t(2265),o=t(72894),a=t(64280),i=t(77480),c=t(9224),l=t(83523),d=t(3089),u=t(24033);function h(e){let{error:r,errorInfo:t,resetError:n,showDetails:h,toggleDetails:m}=e;const f=(0,u.useRouter)();return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"max-w-2xl w-full",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 sm:p-8",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,s.jsx)("div",{className:"h-20 w-20 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center mb-4",children:(0,s.jsx)(o.Z,{className:"h-10 w-10 text-red-600 dark:text-red-400"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Oops! Something went wrong"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"We encountered an unexpected error. Don't worry, your data is safe."})]}),r&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm font-mono text-red-800 dark:text-red-300",children:r.message||"An unknown error occurred"})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[(0,s.jsxs)(d.z,{onClick:n,className:"flex-1",variant:"default",children:[(0,s.jsx)(a.Z,{className:"mr-2 h-4 w-4"}),"Try Again"]}),(0,s.jsxs)(d.z,{onClick:()=>f.push("/"),className:"flex-1",variant:"outline",children:[(0,s.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Go to Home"]})]}),(0,s.jsx)("button",{onClick:m,className:"w-full text-left text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Technical Details"}),h?(0,s.jsx)(c.Z,{className:"h-4 w-4"}):(0,s.jsx)(l.Z,{className:"h-4 w-4"})]})}),h&&t&&(0,s.jsxs)("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-900 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Stack Trace:"}),(0,s.jsx)("pre",{className:"text-xs text-gray-600 dark:text-gray-400 overflow-auto max-h-48",children:t.componentStack}),(null===r||void 0===r?void 0:r.stack)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mt-4 mb-2",children:"Error Stack:"}),(0,s.jsx)("pre",{className:"text-xs text-gray-600 dark:text-gray-400 overflow-auto max-h-48",children:r.stack})]})]})]}),(0,s.jsx)("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 mt-6",children:"If this problem persists, please contact support with the error details above."})]})})}class m extends n.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){var t,s;null===(t=(s=this.props).onError)||void 0===t||t.call(s,e,r),this.setState({errorInfo:r})}componentDidUpdate(e){const{resetKeys:r,resetOnPropsChange:t}=this.props,{hasError:s}=this.state;if(s&&r){r.some(((r,t)=>{var s;return r!==(null===(s=e.resetKeys)||void 0===s?void 0:s[t])}))&&this.resetError()}s&&t&&e!==this.props&&this.resetError()}render(){const{hasError:e,error:r,errorInfo:t,showDetails:n}=this.state,{children:o,fallback:a=h}=this.props;return e?(0,s.jsx)(a,{error:r,errorInfo:t,resetError:this.resetError,showDetails:n,toggleDetails:this.toggleDetails}):o}constructor(e){super(e),this.resetError=()=>{this.setState({hasError:!1,error:null,errorInfo:null,showDetails:!1})},this.toggleDetails=()=>{this.setState((e=>({showDetails:!e.showDetails})))},this.state={hasError:!1,error:null,errorInfo:null,showDetails:!1}}}function f(e){let{children:r,fallback:t}=e;return(0,s.jsx)(m,{fallback:e=>{let{resetError:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:[(0,s.jsx)(o.Z,{className:"h-12 w-12 text-yellow-500 mb-4"}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Failed to load content"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 text-center",children:"We couldn't load this section. Please check your connection and try again."}),(0,s.jsxs)(d.z,{onClick:r,size:"sm",children:[(0,s.jsx)(a.Z,{className:"mr-2 h-4 w-4"}),"Retry"]})]})},children:(0,s.jsx)(n.Suspense,{fallback:t,children:r})})}function g(e){let{onRetry:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:[(0,s.jsx)("div",{className:"h-20 w-20 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"h-10 w-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})})}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"No Internet Connection"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 text-center max-w-sm",children:"Please check your internet connection and try again."}),r&&(0,s.jsxs)(d.z,{onClick:r,size:"sm",children:[(0,s.jsx)(a.Z,{className:"mr-2 h-4 w-4"}),"Try Again"]})]})}function x(){const e=(0,u.useRouter)();return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen p-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-9xl font-bold text-gray-200 dark:text-gray-800",children:"404"}),(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mt-4 mb-2",children:"Page Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-8 max-w-md",children:"The page you're looking for doesn't exist or has been moved."}),(0,s.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,s.jsx)(d.z,{onClick:()=>e.back(),variant:"outline",children:"Go Back"}),(0,s.jsxs)(d.z,{onClick:()=>e.push("/"),children:[(0,s.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Go Home"]})]})]})})}function v(e){let{message:r="You don't have permission to access this resource"}=e;const t=(0,u.useRouter)();return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-8",children:[(0,s.jsx)("div",{className:"h-20 w-20 rounded-full bg-yellow-100 dark:bg-yellow-900/20 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"h-10 w-10 text-yellow-600 dark:text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 text-center max-w-sm",children:r}),(0,s.jsxs)(d.z,{onClick:()=>t.push("/"),size:"sm",children:[(0,s.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Go to Home"]})]})}},60688:function(e,r,t){"use strict";t.r(r),t.d(r,{ThemeProvider:function(){return o}});var s=t(57437),n=(t(2265),t(6435));function o(e){let{children:r,...t}=e;return(0,s.jsx)(n.f,{...t,children:r})}},3089:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var s=t(57437),n=t(2265),o=t(67256),a=t(96061),i=t(60345);const c=(0,a.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm hover:shadow-md",success:"bg-success text-success-foreground hover:bg-success/90 shadow-sm hover:shadow-md",warning:"bg-warning text-warning-foreground hover:bg-warning/90 shadow-sm hover:shadow-md",info:"bg-info text-info-foreground hover:bg-info/90 shadow-sm hover:shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-accent-foreground/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground hover:scale-105",link:"text-primary underline-offset-4 hover:underline hover:text-primary/80",nova:"bg-gradient-to-r from-nova-500 to-nova-600 text-white hover:from-nova-600 hover:to-nova-700 shadow-md hover:shadow-lg"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef(((e,r)=>{let{className:t,variant:n,size:a,asChild:l=!1,...d}=e;const u=l?o.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(c({variant:n,size:a,className:t})),ref:r,...d})}));l.displayName="Button"},23570:function(e,r,t){"use strict";t.r(r),t.d(r,{RBACProvider:function(){return c},useRBAC:function(){return l}});var s=t(57437),n=t(2265),o=t(16746);const a=(0,n.createContext)(void 0),i=[{id:"super-admin",name:"Super Administrator",description:"Full system access with all permissions",isSystemRole:!0,permissions:[{resource:"*",actions:["*"]}]},{id:"admin",name:"Administrator",description:"System administration with most permissions",isSystemRole:!0,permissions:[{resource:"users",actions:["create","read","update","delete"]},{resource:"vms",actions:["create","read","update","delete","migrate"]},{resource:"monitoring",actions:["read","configure"]},{resource:"security",actions:["read","configure"]},{resource:"backups",actions:["create","read","restore"]},{resource:"settings",actions:["read","update"]}]},{id:"operator",name:"Operator",description:"VM operations and monitoring access",isSystemRole:!0,permissions:[{resource:"vms",actions:["read","update","migrate"]},{resource:"monitoring",actions:["read"]},{resource:"backups",actions:["create","read"]}]},{id:"viewer",name:"Viewer",description:"Read-only access to system resources",isSystemRole:!0,permissions:[{resource:"vms",actions:["read"]},{resource:"monitoring",actions:["read"]},{resource:"backups",actions:["read"]}]}];function c(e){let{children:r}=e;const{user:t}=(0,o.useAuth)(),n=(()=>{if(!t)return[];const e=t.roles||["viewer"];return i.filter((r=>e.includes(r.id)))})(),c=Array.isArray(n)?n.flatMap((e=>(null===e||void 0===e?void 0:e.permissions)||[])):[],l=(e,r)=>{if(!t||!Array.isArray(c))return!1;return!!c.some((e=>{var r;return"*"===(null===e||void 0===e?void 0:e.resource)&&(null===e||void 0===e||null===(r=e.actions)||void 0===r?void 0:r.includes("*"))}))||c.some((t=>{if(!t||!t.actions)return!1;const s=t.resource===e||"*"===t.resource,n=t.actions.includes(r)||t.actions.includes("*");return s&&n}))},d=e=>!!Array.isArray(n)&&n.some((r=>(null===r||void 0===r?void 0:r.id)===e||(null===r||void 0===r?void 0:r.name)===e));return(0,s.jsx)(a.Provider,{value:{userRoles:n,permissions:c,hasPermission:l,hasRole:d,canAccess:(e,r)=>{if(!t)return!1;if(Array.isArray(e)&&e.length>0){if(!e.some((e=>d(e))))return!1}if(Array.isArray(r)&&r.length>0){if(!r.every((e=>l(null===e||void 0===e?void 0:e.resource,null===e||void 0===e?void 0:e.action))))return!1}return!0}},children:r})}function l(){const e=(0,n.useContext)(a);if(void 0===e)throw new Error("useRBAC must be used within an RBACProvider");return e}},16746:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return c},useAuth:function(){return l}});var s=t(57437),n=t(2265),o=t(24033),a=t(50471);const i=(0,n.createContext)(void 0);function c(e){let{children:r}=e;const[t,c]=(0,n.useState)(null),[l,d]=(0,n.useState)(!0),[u,h]=(0,n.useState)(!1),[m,f]=(0,n.useState)(null),g=(0,o.useRouter)();(0,n.useEffect)((()=>{const e=a.O.getToken(),r=a.O.getTempToken();if(e){const e=a.O.getCurrentUser();c(e)}else r&&(f(r),h(!0));d(!1)}),[]);return(0,s.jsx)(i.Provider,{value:{user:t,isLoading:l,isAuthenticated:!!t,requires2FA:u,tempToken:m,login:async(e,r)=>{try{const t=await a.O.login({email:e,password:r});t.requires_2fa&&t.temp_token?(a.O.setTempToken(t.temp_token),f(t.temp_token),h(!0)):(a.O.setToken(t.token,t.user),c(t.user),h(!1),f(null))}catch(t){throw console.error("Login failed:",t),t}},logout:()=>{a.O.logout(),c(null),h(!1),f(null),g.push("/auth/login")},verify2FA:async e=>{if(!m)throw new Error("No temporary token available");try{const r=await a.O.verify2FALogin({code:e,temp_token:m});a.O.setToken(r.token,r.user),a.O.removeTempToken(),c(r.user),h(!1),f(null)}catch(r){throw console.error("2FA verification failed:",r),r}}},children:r})}function l(){const e=(0,n.useContext)(i);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},50471:function(e,r,t){"use strict";t.d(r,{O:function(){return n}});const s=t(59792).env.NEXT_PUBLIC_API_URL||"http://localhost:8090";const n=new class{async request(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t="".concat(s).concat(e),n={headers:{"Content-Type":"application/json",...r.headers},...r};try{const e=await fetch(t,n);if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(o){throw console.error("API request failed for ".concat(e,":"),o),o}}async login(e){return this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)})}async register(e){return this.request("/api/auth/register",{method:"POST",body:JSON.stringify(e)})}async forgotPassword(e){return this.request("/api/auth/forgot-password",{method:"POST",body:JSON.stringify(e)})}async resetPassword(e){return this.request("/api/auth/reset-password",{method:"POST",body:JSON.stringify(e)})}decodeJWT(e){try{const r=e.split(".");if(3!==r.length)throw new Error("Invalid JWT format");const t=r[1],s=atob(t.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(s)}catch(r){return console.error("Failed to decode JWT:",r),null}}getCurrentUser(){const e=this.getToken();if(!e)return null;try{const r=this.decodeJWT(e);if(!r)return this.removeToken(),null;if(r.exp&&1e3*r.exp<Date.now())return this.removeToken(),null;const t={id:r.sub||r.user_id||r.id,email:r.email||"",firstName:r.firstName||r.first_name||r.given_name||"",lastName:r.lastName||r.last_name||r.family_name||"",tenantId:r.tenantId||r.tenant_id,status:r.status||"active",two_factor_enabled:r.two_factor_enabled||r["2fa_enabled"]||!1};return localStorage.setItem("authUser",JSON.stringify(t)),t}catch(r){return console.error("Error getting current user:",r),this.removeToken(),null}}isAuthenticated(){return!!this.getToken()}getToken(){return localStorage.getItem("novacron_token")}setToken(e,r){localStorage.setItem("novacron_token",e),r&&localStorage.setItem("authUser",JSON.stringify(r))}removeToken(){localStorage.removeItem("novacron_token"),localStorage.removeItem("authUser"),localStorage.removeItem("tempToken")}logout(){this.removeToken()}async setup2FA(){const e=this.getToken(),r=this.getCurrentUser();if(!r)throw new Error("User not authenticated");return this.request("/api/auth/2fa/setup",{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:JSON.stringify({user_id:r.id,account_name:r.email})})}async verify2FASetup(e){const r=this.getToken(),t=this.getCurrentUser();if(!t&&!e.user_id)throw new Error("User ID required for 2FA verification");return this.request("/api/auth/2fa/verify",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({user_id:e.user_id||(null===t||void 0===t?void 0:t.id),code:e.code,is_backup_code:e.is_backup_code||!1})})}async verify2FALogin(e){return this.request("/api/auth/2fa/verify-login",{method:"POST",body:JSON.stringify({user_id:e.user_id,code:e.code,is_backup_code:e.is_backup_code||!1,temp_token:e.temp_token})})}async enable2FA(e){const r=this.getCurrentUser();if(!r)throw new Error("User not authenticated");const t=this.getToken();return this.request("/api/auth/2fa/enable",{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:JSON.stringify({user_id:r.id,code:e})})}async disable2FA(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const r=this.getToken();return this.request("/api/auth/2fa/disable",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({user_id:e.id})})}async get2FAStatus(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const r=this.getToken(),t=await this.request("/api/auth/2fa/status?user_id="+e.id,{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});return{enabled:t.enabled,backup_codes_remaining:0,setup:t.setup,setup_at:t.setup_at,last_used:t.last_used}}async generateBackupCodes(){const e=this.getCurrentUser();if(!e)throw new Error("User not authenticated");const r=this.getToken();return this.request("/api/auth/2fa/backup-codes",{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({user_id:e.id})})}setTempToken(e){localStorage.setItem("tempToken",e)}getTempToken(){return localStorage.getItem("tempToken")}removeTempToken(){localStorage.removeItem("tempToken")}}},60345:function(e,r,t){"use strict";t.d(r,{cn:function(){return o}});var s=t(50348),n=t(23986);function o(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.m)((0,s.W)(r))}},61003:function(e,r,t){"use strict";t.r(r),t.d(r,{QueryProvider:function(){return c}});var s=t(57437),n=t(35171),o=t(70165),a=t(57021),i=t(2265);function c(e){let{children:r}=e;const[t]=(0,i.useState)((()=>new n.S({defaultOptions:{queries:{staleTime:6e4,retry:1,refetchOnWindowFocus:!1}}})));return(0,s.jsxs)(o.aH,{client:t,children:[r,(0,s.jsx)(a.t,{initialIsOpen:!1})]})}},92489:function(){}},function(e){e.O(0,[155,2649,5920,6070,2971,2472,1744],(function(){return r=39067,e(e.s=r);var r}));var r=e.O();_N_E=r}]);