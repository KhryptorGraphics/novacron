"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3787],{33787:function(e,t,s){s.r(t),s.d(t,{NetworkTopology:function(){return f}});var i=s(57437),n=s(2265),a=s(10609),r=s(41735),l=s(40150),c=s(3089),o=s(8031),h=s(28956),d=s(90998),u=s(26714);const f=e=>{let{data:t,title:s="Network Topology",description:f,height:x=400,showDistributed:m=!1,showBandwidth:g=!1,showPerformanceMetrics:y=!1,autoRefresh:v=!0,refreshInterval:p=5e3,onNodeClick:w,onEdgeClick:M,onClusterClick:b}=e;const j=(0,n.useRef)(null),k=(0,n.useRef)(),[N,E]=n.useState("force"),[S,C]=n.useState(null),[P,I]=n.useState(null),[L,z]=n.useState(!0),[W,D]=n.useState("medium"),[H,O]=n.useState(new Set),[T,A]=n.useState(m),[B,F]=n.useState(g),[q,Q]=n.useState(y);(0,n.useEffect)((()=>A(m)),[m]),(0,n.useEffect)((()=>F(g)),[g]),(0,n.useEffect)((()=>Q(y)),[y]);const{data:R,isConnected:U}=T?(0,o.lt)():{data:null,isConnected:!1},V=n.useMemo((()=>R&&T?R:t||{nodes:[],edges:[],clusters:[]}),[R,t,T]);return(0,n.useEffect)((()=>{if(!j.current||!V.nodes.length)return;const e=j.current,t=e.getContext("2d");if(!t)return;const s=()=>{const s=window.devicePixelRatio||1;e.width=Math.floor(e.clientWidth*s),e.height=Math.floor(e.clientHeight*s),e.style.width=e.clientWidth+"px",e.style.height=e.clientHeight+"px",t.scale(s,s)};window.addEventListener("resize",s),s();const i=new Map;(()=>{const t=e.clientWidth,s=e.clientHeight;V.nodes.forEach(((e,n)=>{let a,r;switch(N){case"circular":const i=n/V.nodes.length*2*Math.PI,l=.3*Math.min(t,s);a=t/2+Math.cos(i)*l,r=s/2+Math.sin(i)*l;break;case"hierarchical":new Map;let c=0;c="cluster"===e.type?0:"host"===e.type?1:"vm"===e.type?2:3;const o=V.nodes.filter((e=>{let t=0;return t="cluster"===e.type?0:"host"===e.type?1:"vm"===e.type?2:3,t===c})),h=o.findIndex((t=>t.id===e.id));a=t/(o.length+1)*(h+1),r=s/5*(c+1);break;case"geographic":const d={"us-east-1":{x:.8*t,y:.3*s},"us-west-2":{x:.2*t,y:.4*s},"eu-west-1":{x:.6*t,y:.2*s},"ap-southeast-1":{x:.9*t,y:.7*s}}[e.region];a=(null===d||void 0===d?void 0:d.x)||Math.random()*t,r=(null===d||void 0===d?void 0:d.y)||Math.random()*s;break;case"clustered":if(e.clusterId&&V.clusters){const i=V.clusters.find((t=>t.id===e.clusterId));(null===i||void 0===i?void 0:i.bounds)?(a=i.bounds.x+Math.random()*i.bounds.width,r=i.bounds.y+Math.random()*i.bounds.height):(a=Math.random()*t,r=Math.random()*s)}else a=Math.random()*t,r=Math.random()*s;break;default:a=Math.random()*t,r=Math.random()*s}i.set(e.id,{x:a,y:r,vx:0,vy:0})}))})();const n={vm:"#4f46e5",host:"#0891b2",storage:"#7c3aed",network:"#2563eb",service:"#059669",cluster:"#f59e0b",federation:"#ec4899"},a={healthy:"#10b981",warning:"#f59e0b",error:"#ef4444",unknown:"#6b7280"},r={network:"rgba(37, 99, 235, 0.5)",storage:"rgba(124, 58, 237, 0.5)",dependency:"rgba(156, 163, 175, 0.5)",cluster:"rgba(245, 158, 11, 0.5)",federation:"rgba(236, 72, 153, 0.5)",migration:"rgba(34, 197, 94, 0.5)"},l=e=>{var t;if(!B||!(null===(t=e.metrics)||void 0===t?void 0:t.bandwidth))return 1;const s=Math.max(1,Math.min(8,e.metrics.bandwidth/10));return e.metrics.utilization?s*(e.metrics.utilization/100):s},c=e=>{if(!e.bounds||!T)return;const{x:s,y:i,width:n,height:a}=e.bounds;t.strokeStyle="rgba(245, 158, 11, 0.3)",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(s,i,n,a),t.setLineDash([]),t.font="12px sans-serif",t.fillStyle="#f59e0b",t.textAlign="left",t.fillText("".concat(e.name," (").concat(e.region,")"),s+5,i-5);const r={healthy:"#10b981",degraded:"#f59e0b",error:"#ef4444"}[e.status];t.fillStyle=r,t.beginPath(),t.arc(s+n-10,i+10,5,0,2*Math.PI),t.fill()},o=(e,s)=>{const i="host"===e.type||"cluster"===e.type?15:10;t.beginPath(),t.arc(s.x,s.y,i,0,2*Math.PI),t.fillStyle=n[e.type],t.fill(),t.beginPath(),t.arc(s.x,s.y,i+3,0,2*Math.PI),t.strokeStyle=a[e.status],t.lineWidth=2,t.stroke(),L&&(t.font="10px sans-serif",t.fillStyle="#ffffff",t.textAlign="center",t.textBaseline="middle",t.fillText(e.name.substring(0,2),s.x,s.y),t.font="10px sans-serif",t.fillStyle="#374151",t.textAlign="center",t.textBaseline="top",t.fillText(e.name,s.x,s.y+i+5)),q&&e.metrics&&"low"!==W&&(t.font="9px sans-serif",t.fillStyle="#6b7280",t.textAlign="center",void 0!==e.metrics.cpuUsage&&t.fillText("CPU: ".concat(e.metrics.cpuUsage,"%"),s.x,s.y+i+18),void 0!==e.metrics.memoryUsage&&"high"===W&&t.fillText("Mem: ".concat(e.metrics.memoryUsage,"%"),s.x,s.y+i+28)),"migrating"===e.status&&(t.strokeStyle="rgba(34, 197, 94, 0.8)",t.lineWidth=3,t.setLineDash([2,2]),t.beginPath(),t.arc(s.x,s.y,i+6,0,2*Math.PI),t.stroke(),t.setLineDash([]))},h=(e,s,i)=>{var n;const a=B&&(null===(n=e.metrics)||void 0===n?void 0:n.utilization)?(c=e.metrics.utilization)?c>80?"rgba(239, 68, 68, 0.7)":c>60?"rgba(245, 158, 11, 0.7)":"rgba(34, 197, 94, 0.7)":r.network:r[e.type];var c;if(t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(i.x,i.y),t.strokeStyle=a,t.lineWidth=l(e),"dependency"===e.type?t.setLineDash([5,3]):t.setLineDash([]),t.stroke(),t.setLineDash([]),q&&e.metrics&&"low"!==W){const n=(s.x+i.x)/2,a=(s.y+i.y)/2;t.font="9px sans-serif",t.fillStyle="#6b7280",t.textAlign="center",t.textBaseline="middle";const r=[];if(e.metrics.latency&&r.push("".concat(e.metrics.latency.toFixed(1),"ms")),B&&e.metrics.bandwidth&&r.push("".concat(e.metrics.bandwidth,"Mbps")),e.metrics.utilization&&"high"===W&&r.push("".concat(e.metrics.utilization,"%")),r.length>0&&t.fillText(r.join(" | "),n,a-8),e.metrics.qos){const s={high:"#10b981",medium:"#f59e0b",low:"#ef4444"}[e.metrics.qos];t.fillStyle=s,t.beginPath(),t.arc(n,a+8,3,0,2*Math.PI),t.fill()}}if(e.animated||"migration"===e.type){const e=t.createLinearGradient(s.x,s.y,i.x,i.y);e.addColorStop(0,"rgba(34, 197, 94, 0)"),e.addColorStop(.5,"rgba(34, 197, 94, 0.8)"),e.addColorStop(1,"rgba(34, 197, 94, 0)"),t.strokeStyle=e,t.lineWidth=2,t.stroke()}};class d{insert(e,t){if(!this.contains(t.x,t.y))return!1;if(0===this.nodes.length&&0===this.children.length)return this.nodes.push({node:e,position:t}),this.updateCenterOfMass(),!0;if(0===this.children.length){this.subdivide();for(const e of this.nodes)for(const t of this.children)if(t.insert(e.node,e.position))break;this.nodes=[]}for(const s of this.children)if(s.insert(e,t))return this.updateCenterOfMass(),!0;return!1}contains(e,t){return e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}subdivide(){const e=this.width/2,t=this.height/2;this.children.push(new d(this.x,this.y,e,t),new d(this.x+e,this.y,e,t),new d(this.x,this.y+t,e,t),new d(this.x+e,this.y+t,e,t))}updateCenterOfMass(){let e=0,t=0,s=0;for(const{position:i}of this.nodes)e+=i.x,t+=i.y,s+=1;for(const i of this.children)e+=i.centerOfMass.x*i.totalMass,t+=i.centerOfMass.y*i.totalMass,s+=i.totalMass;s>0&&(this.centerOfMass.x=e/s,this.centerOfMass.y=t/s),this.totalMass=s}calculateForce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(0===this.totalMass)return{fx:0,fy:0};const s=this.centerOfMass.x-e.x,i=this.centerOfMass.y-e.y,n=Math.sqrt(s*s+i*i);if(0===n)return{fx:0,fy:0};const a=Math.max(this.width,this.height);if(0===this.children.length||a/n<t){const e=1e3/(n*n);return{fx:s/n*e,fy:i/n*e}}let r=0,l=0;for(const c of this.children){const s=c.calculateForce(e,t);r+=s.fx,l+=s.fy}return{fx:r,fy:l}}constructor(e,t,s,i){this.x=e,this.y=t,this.width=s,this.height=i,this.nodes=[],this.centerOfMass={x:0,y:0},this.totalMass=0,this.children=[]}}const u=()=>{t.clearRect(0,0,e.width,e.height),V.clusters&&T&&V.clusters.forEach((e=>{const t=V.nodes.filter((t=>t.clusterId===e.id));if(t.length>0){const s=t.map((e=>i.get(e.id))).filter(Boolean);if(s.length>0){const t=Math.min(...s.map((e=>e.x)))-50,i=Math.max(...s.map((e=>e.x)))+50,n=Math.min(...s.map((e=>e.y)))-50,a=Math.max(...s.map((e=>e.y)))+50;e.bounds={x:t,y:n,width:i-t,height:a-n}}}c(e)}));const s=V.nodes.length>100?3:10,n=V.nodes.length>100;for(let t=0;t<s;t++){if(n){const t=new d(0,0,e.clientWidth,e.clientHeight);V.nodes.forEach((e=>{const s=i.get(e.id);s&&t.insert(e,s)})),V.nodes.forEach((e=>{const s=i.get(e.id);if(s){const e=t.calculateForce(s);s.vx-=e.fx,s.vy-=e.fy}}))}else V.nodes.forEach((e=>{V.nodes.forEach((t=>{if(e.id===t.id)return;const s=i.get(e.id),n=i.get(t.id),a=n.x-s.x,r=n.y-s.y,l=Math.sqrt(a*a+r*r);if(0===l)return;const c=1e3/(l*l),o=a/l*c,h=r/l*c;s.vx-=o,s.vy-=h,n.vx+=o,n.vy+=h}))}));V.edges.forEach((e=>{const t=i.get(e.source),s=i.get(e.target);if(!t||!s)return;const n=s.x-t.x,a=s.y-t.y,r=Math.sqrt(n*n+a*a);if(0===r)return;const l=.01*(r-100),c=n/r*l,o=a/r*l;t.vx+=c,t.vy+=o,s.vx-=c,s.vy-=o})),i.forEach((t=>{t.x+=.1*t.vx,t.y+=.1*t.vy,t.vx*=.9,t.vy*=.9,t.x=Math.max(50,Math.min(e.clientWidth-50,t.x)),t.y=Math.max(50,Math.min(e.clientHeight-50,t.y))}))}V.edges.forEach((e=>{const t=i.get(e.source),s=i.get(e.target);t&&s&&h(e,t,s)})),V.nodes.forEach((e=>{const t=i.get(e.id);t&&o(e,t)})),"force"===N&&(k.current=requestAnimationFrame(u))};(()=>{if(k.current&&cancelAnimationFrame(k.current),"force"===N)u();else{let s;switch(N){case"circular":s=(()=>{const t=e.clientWidth,s=e.clientHeight,i=.3*Math.min(t,s),n=new Map;return V.nodes.forEach(((e,a)=>{const r=a/V.nodes.length*2*Math.PI,l=t/2+Math.cos(r)*i,c=s/2+Math.sin(r)*i;n.set(e.id,{x:l,y:c,vx:0,vy:0})})),n})();break;case"hierarchical":s=(()=>{const t=e.clientWidth,s=e.clientHeight,i=new Map,n=new Map;return V.nodes.forEach((e=>{let t=0;t="cluster"===e.type?0:"host"===e.type?1:"vm"===e.type?2:3,n.has(t)||n.set(t,[]),n.get(t).push(e)})),Array.from(n.entries()).forEach((e=>{let[n,a]=e;const r=s/5*(n+1);a.forEach(((e,s)=>{const n=t/(a.length+1)*(s+1);i.set(e.id,{x:n,y:r,vx:0,vy:0})}))})),i})();break;case"geographic":s=(()=>{const t=e.clientWidth,s=e.clientHeight,i=new Map,n={"us-east-1":{x:.8*t,y:.3*s},"us-west-2":{x:.2*t,y:.4*s},"eu-west-1":{x:.6*t,y:.2*s},"ap-southeast-1":{x:.9*t,y:.7*s}};return V.nodes.forEach((e=>{const a=n[e.region],r=(null===a||void 0===a?void 0:a.x)||Math.random()*t,l=(null===a||void 0===a?void 0:a.y)||Math.random()*s;i.set(e.id,{x:r,y:l,vx:0,vy:0})})),i})();break;case"clustered":s=(()=>{const t=e.clientWidth,s=e.clientHeight,i=new Map;return V.nodes.forEach((e=>{let n,a;if(e.clusterId&&V.clusters){const i=V.clusters.find((t=>t.id===e.clusterId));(null===i||void 0===i?void 0:i.bounds)?(n=i.bounds.x+Math.random()*i.bounds.width,a=i.bounds.y+Math.random()*i.bounds.height):(n=Math.random()*t,a=Math.random()*s)}else n=Math.random()*t,a=Math.random()*s;i.set(e.id,{x:n,y:a,vx:0,vy:0})})),i})();break;default:s=new Map}s.forEach(((e,t)=>{i.set(t,e)})),t.clearRect(0,0,e.width,e.height),V.clusters&&T&&V.clusters.forEach((e=>{const t=V.nodes.filter((t=>t.clusterId===e.id));if(t.length>0){const s=t.map((e=>i.get(e.id))).filter(Boolean);if(s.length>0){const t=Math.min(...s.map((e=>e.x)))-50,i=Math.max(...s.map((e=>e.x)))+50,n=Math.min(...s.map((e=>e.y)))-50,a=Math.max(...s.map((e=>e.y)))+50;e.bounds={x:t,y:n,width:i-t,height:a-n}}}c(e)})),V.edges.forEach((e=>{const t=i.get(e.source),s=i.get(e.target);t&&s&&h(e,t,s)})),V.nodes.forEach((e=>{const t=i.get(e.id);t&&o(e,t)}))}})();let f=null;v&&p>0&&(f=setInterval((()=>{}),p));const x=t=>{const s=e.getBoundingClientRect(),n=t.clientX-s.left,a=t.clientY-s.top;for(const e of V.nodes){const t=i.get(e.id);if(!t)continue;const s="host"===e.type||"cluster"===e.type?15:10;if(Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-a,2))<=s+3)return void(w&&w(e))}if(V.clusters&&T)for(const e of V.clusters)if(e.bounds){const{x:t,y:s,width:i,height:r}=e.bounds;if(n>=t&&n<=t+i&&a>=s&&a<=s+r){b&&b(e);const t=H.has(e.id),s=new Set(H);return t?s.delete(e.id):s.add(e.id),void O(s)}}for(const e of V.edges){const t=i.get(e.source),s=i.get(e.target);if(!t||!s)continue;const r=n-t.x,c=a-t.y,o=s.x-t.x,h=s.y-t.y,d=r*o+c*h,u=o*o+h*h;let f,x,m=-1;0!==u&&(m=d/u),m<0?(f=t.x,x=t.y):m>1?(f=s.x,x=s.y):(f=t.x+m*o,x=t.y+m*h);const g=n-f,y=a-x;if(Math.sqrt(g*g+y*y)<=l(e)+2)return void(M&&M(e))}};return e.addEventListener("click",x),()=>{e.removeEventListener("click",x),window.removeEventListener("resize",s),k.current&&cancelAnimationFrame(k.current),f&&clearInterval(f)}}),[V,N,T,B,q,L,W,v,p,w,M,b,H]),(0,i.jsxs)(a.Zb,{children:[(0,i.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(a.ll,{children:s}),f&&(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]}),(0,i.jsxs)(r.Ph,{value:N,onValueChange:E,children:[(0,i.jsx)(r.i4,{className:"w-[180px]",children:(0,i.jsx)(r.ki,{placeholder:"Layout Type"})}),(0,i.jsxs)(r.Bw,{children:[(0,i.jsx)(r.Ql,{value:"force",children:"Force-Directed"}),(0,i.jsx)(r.Ql,{value:"circular",children:"Circular"}),(0,i.jsx)(r.Ql,{value:"hierarchical",children:"Hierarchical"}),(0,i.jsx)(r.Ql,{value:"geographic",children:"Geographic"}),(0,i.jsx)(r.Ql,{value:"clustered",children:"Clustered"})]})]})]}),(0,i.jsxs)(a.aY,{children:[(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,i.jsxs)(c.z,{size:"sm",variant:T?"default":"outline",onClick:()=>A(!T),children:[(0,i.jsx)(h.Z,{className:"h-4 w-4 mr-1"}),"Distributed View"]}),(0,i.jsxs)(c.z,{size:"sm",variant:B?"default":"outline",onClick:()=>F(!B),children:[(0,i.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Bandwidth"]}),(0,i.jsxs)(c.z,{size:"sm",variant:q?"default":"outline",onClick:()=>Q(!q),children:[(0,i.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"Metrics"]}),(0,i.jsxs)(r.Ph,{value:W,onValueChange:e=>D(e),children:[(0,i.jsx)(r.i4,{className:"w-[120px] h-8",children:(0,i.jsx)(r.ki,{})}),(0,i.jsxs)(r.Bw,{children:[(0,i.jsx)(r.Ql,{value:"low",children:"Low Detail"}),(0,i.jsx)(r.Ql,{value:"medium",children:"Medium Detail"}),(0,i.jsx)(r.Ql,{value:"high",children:"High Detail"})]})]}),T&&U&&(0,i.jsxs)(l.C,{variant:"outline",className:"ml-auto",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),"Live Updates"]})]}),(0,i.jsx)("div",{className:"relative",style:{height:"".concat(x,"px")},children:(0,i.jsx)("canvas",{ref:j,className:"w-full h-full",style:{touchAction:"none"}})}),(0,i.jsxs)("div",{className:"flex justify-center mt-4 space-x-4",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#4f46e5] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"VM"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#0891b2] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Host"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#7c3aed] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Storage"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#2563eb] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Network"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#059669] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Service"})]}),T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#f59e0b] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Cluster"})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#ec4899] mr-2"}),(0,i.jsx)("span",{className:"text-xs",children:"Federation"})]})]})]})]})]})}}}]);