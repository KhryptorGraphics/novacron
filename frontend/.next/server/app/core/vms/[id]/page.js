(()=>{var e={id:6964,ids:[6964]};e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},77506:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>a.ZP,__next_app__:()=>u,originalPathname:()=>l,pages:()=>c,routeModule:()=>m,tree:()=>o});var t=s(67096),i=s(16132),a=s(78658),n=s(32564),d={};for(const v in n)["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(v)<0&&(d[v]=()=>n[v]);s.d(r,d);const o=["",{children:["core",{children:["vms",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,15933)),"/home/kp/novacron/frontend/src/app/core/vms/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,35519)),"/home/kp/novacron/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/home/kp/novacron/frontend/src/app/core/vms/[id]/page.tsx"],l="/core/vms/[id]/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/core/vms/[id]/page",pathname:"/core/vms/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},47142:(e,r,s)=>{Promise.resolve().then(s.bind(s,95367))},95367:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>y,dynamic:()=>g});var t=s(30784),i=s(11440),a=s.n(i),n=s(9885),d=s(57114),o=s(212),c=s(53993),l=s(67397);var u=s(30012);function m(e,r,s){const t=(0,o.NL)();return(0,u.D)({mutationKey:["vm-action",e,r,s?.role],mutationFn:()=>(0,l.cD)(e,r,{role:s?.role}),onMutate:async()=>{},onSuccess:async()=>{await Promise.all([t.invalidateQueries({queryKey:["vm",e]}),t.invalidateQueries({queryKey:["vms"]})])}})}var v=s(99748),x=s(17133),p=s(45304),h=s(97040);const g="force-dynamic";function y(){const e=(0,d.useParams)(),r="string"===typeof e?.id?e.id:Array.isArray(e?.id)?e?.id?.[0]:"",{vm:s,isLoading:i,error:u}=function(e){const{data:r,isLoading:s,error:t}=(0,c.a)({queryKey:["vm",e],queryFn:()=>(0,l.OC)(e),enabled:Boolean(e)});return{vm:r?.data??null,isLoading:s,error:t}}(r),{toast:g}=(0,v.p)(),y=(0,o.NL)(),[j,f]=(0,n.useState)("viewer");(0,n.useEffect)((()=>{try{const e=localStorage.getItem("coreRole");"viewer"!==e&&"operator"!==e||f(e)}catch{}}),[]);const q="operator"!==j,S=m(r,"start",{role:j}),P=m(r,"stop",{role:j}),_=m(r,"restart",{role:j}),N=m(r,"pause",{role:j}),b=m(r,"resume",{role:j});return(0,n.useEffect)((()=>{S.isSuccess&&(g({title:"Start requested"}),y.invalidateQueries({queryKey:["vm",r]}),y.invalidateQueries({queryKey:["vms"]})),P.isSuccess&&(g({title:"Stop requested"}),y.invalidateQueries({queryKey:["vm",r]}),y.invalidateQueries({queryKey:["vms"]})),_.isSuccess&&(g({title:"Restart requested"}),y.invalidateQueries({queryKey:["vm",r]}),y.invalidateQueries({queryKey:["vms"]})),N.isSuccess&&(g({title:"Pause requested"}),y.invalidateQueries({queryKey:["vm",r]}),y.invalidateQueries({queryKey:["vms"]})),b.isSuccess&&(g({title:"Resume requested"}),y.invalidateQueries({queryKey:["vm",r]}),y.invalidateQueries({queryKey:["vms"]}))}),[S.isSuccess,P.isSuccess,_.isSuccess,N.isSuccess,b.isSuccess,r,g,y]),(0,n.useEffect)((()=>{S.isError&&g({title:"Start failed",description:String(S.error?.message??S.error),variant:"destructive"}),P.isError&&g({title:"Stop failed",description:String(P.error?.message??P.error),variant:"destructive"}),_.isError&&g({title:"Restart failed",description:String(_.error?.message??_.error),variant:"destructive"}),N.isError&&g({title:"Pause failed",description:String(N.error?.message??N.error),variant:"destructive"}),b.isError&&g({title:"Resume failed",description:String(b.error?.message??b.error),variant:"destructive"})}),[S.isError,P.isError,_.isError,N.isError,b.isError,S.error,P.error,_.error,N.error,b.error,g]),t.jsx("div",{className:"container mx-auto p-6 space-y-6",children:(0,t.jsxs)(h.Zb,{children:[(0,t.jsxs)(h.Ol,{children:[t.jsx(h.ll,{children:"VM Detail"}),t.jsx(h.SZ,{children:t.jsx(a(),{href:"/core/vms",className:"underline",children:"Back to list"})})]}),t.jsx(h.aY,{children:i?t.jsx("div",{children:"Loading VM..."}):u?(0,t.jsxs)("div",{className:"text-red-500",children:["Failed to load VM: ",String(u?.message??u)]}):s?(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"ID"}),t.jsx("div",{className:"font-mono text-xs break-all",children:s.id}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Name"}),t.jsx("div",{children:s.name})]}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"State"}),t.jsx("div",{children:t.jsx(x.C,{children:s.state})})]}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Node"}),t.jsx("div",{children:s.node_id??"-"})]}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Created"}),t.jsx("div",{children:s.created_at})]}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Updated"}),t.jsx("div",{children:s.updated_at})]})]}),"tags"in s&&s.tags?(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:"Tags"}),t.jsx("ul",{className:"list-disc ml-6",children:Object.entries(s.tags).map((([e,r])=>(0,t.jsxs)("li",{children:[(0,t.jsxs)("span",{className:"font-medium",children:[e,":"]})," ",r]},e)))})]}):null,(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(p.z,{size:"sm",variant:"secondary",onClick:()=>S.mutate(),disabled:q||S.isPending,children:"Start"}),t.jsx(p.z,{size:"sm",variant:"secondary",onClick:()=>P.mutate(),disabled:q||P.isPending,children:"Stop"}),t.jsx(p.z,{size:"sm",variant:"secondary",onClick:()=>_.mutate(),disabled:q||_.isPending,children:"Restart"}),t.jsx(p.z,{size:"sm",variant:"secondary",onClick:()=>N.mutate(),disabled:q||N.isPending,children:"Pause"}),t.jsx(p.z,{size:"sm",variant:"secondary",onClick:()=>b.mutate(),disabled:q||b.isPending,children:"Resume"}),q&&t.jsx("div",{className:"text-xs text-muted-foreground self-center",children:"Switch to operator on the list page to enable actions"})]})]}):t.jsx("div",{children:"VM not found."})})]})})}},67397:(e,r,s)=>{"use strict";s.d(r,{OC:()=>a,cD:()=>n,tq:()=>i});var t=s(91904);const i=e=>(0,t.R1)("/vms",e),a=e=>(0,t.R1)(`/vms/${e}`),n=(e,r,s)=>(0,t.sg)(`/vms/${e}/${r}`,void 0,s)},15933:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>a,__esModule:()=>i,default:()=>o,dynamic:()=>d});const t=(0,s(95153).createProxy)(String.raw`/home/kp/novacron/frontend/src/app/core/vms/[id]/page.tsx`),{__esModule:i,$$typeof:a}=t,n=t.default,d=t.dynamic,o=n}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=r.X(0,[5876,1425,1928,3993,12,1440,5319,3215,7133,4975,9748,1904],(()=>{return e=77506,r(r.s=e);var e}));module.exports=s})();