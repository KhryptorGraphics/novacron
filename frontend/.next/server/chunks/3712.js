"use strict";exports.id=3712,exports.ids=[3712],exports.modules={63712:(e,t,s)=>{s.d(t,{LV:()=>a,bc:()=>u,lt:()=>o,sO:()=>r,wD:()=>i,zm:()=>c});var n=s(9885);function r(e,t={}){const{reconnect:s=!0,reconnectInterval:r=5e3,reconnectAttempts:c=5,heartbeat:o=!0,heartbeatInterval:u=3e4,queue:i=!1}=t,[a,h]=(0,n.useState)(null),[b,p]=(0,n.useState)(!1),[f,d]=(0,n.useState)(null),g=(0,n.useRef)(null),w=(0,n.useRef)(0),m=(0,n.useRef)(null),v=(0,n.useRef)(null),S=(0,n.useRef)(null),k=(0,n.useCallback)((()=>{m.current&&(clearInterval(m.current),m.current=null),v.current&&(clearTimeout(v.current),v.current=null)}),[]),q=(0,n.useCallback)((()=>{o&&g.current&&(m.current=setInterval((()=>{g.current?.readyState===WebSocket.OPEN&&g.current.send(JSON.stringify({type:"ping"}))}),u))}),[o,u]),I=(0,n.useCallback)((()=>{try{const n="https:"===window.location.protocol?"wss:":"ws:",o=window.location.host,u=e.startsWith("/")?`${n}//${o}${e}`:e;g.current=new WebSocket(u),g.current.onopen=()=>{p(!0),d(null),w.current=0,q()},g.current.onmessage=e=>{try{const s=JSON.parse(e.data);"pong"!==s.type&&(t.queue?l.enqueue(s):h(s))}catch(s){const n=e.data;t.queue?l.enqueue(n):h(n)}},g.current.onerror=e=>{d(new Error("WebSocket error"))},g.current.onclose=()=>{p(!1),k(),s&&w.current<c&&(w.current++,v.current=setTimeout((()=>{I()}),r))}}catch(n){d(n)}}),[e,s,r,c,q,k]),y=(0,n.useCallback)((e=>{g.current?.readyState===WebSocket.OPEN&&g.current.send("string"===typeof e?e:JSON.stringify(e))}),[]),C=(0,n.useCallback)((()=>{k(),w.current=c,g.current?.close()}),[c,k]),x=(0,n.useCallback)((()=>{w.current=0,C(),setTimeout(I,100)}),[C,I]);return(0,n.useEffect)((()=>(I(),i&&(S.current=l.subscribe((e=>{h(e)}))),()=>{k(),g.current?.close(),S.current&&(S.current(),S.current=null)})),[I,k,i]),{data:a,isConnected:b,error:f,send:y,close:C,reconnect:x}}function c(){return r("/api/ws/monitoring",{heartbeatInterval:2e4})}function o(){return r("/api/ws/network/topology",{heartbeatInterval:15e3,reconnectAttempts:8})}function u(){return r("/api/ws/network/bandwidth",{heartbeatInterval:5e3,reconnectAttempts:12})}function i(){return r("/api/ws/ai/predictions",{heartbeatInterval:3e4,reconnectAttempts:6})}function a(){return r("/api/ws/fabric/global",{heartbeatInterval:2e4,reconnectAttempts:10})}new class{getConnection(e){if(this.connections.has(e))return this.connections.get(e)||null;if(this.connections.size>=this.maxConnections){const e=this.connections.keys().next().value,t=this.connections.get(e);t&&(t.close(),this.connections.delete(e))}try{const t=new WebSocket(e);return this.connections.set(e,t),t}catch{return null}}closeConnection(e){const t=this.connections.get(e);t&&(t.close(),this.connections.delete(e))}closeAllConnections(){this.connections.forEach((e=>e.close())),this.connections.clear()}constructor(){this.connections=new Map,this.maxConnections=10}};const l=new class{start(){this.processor||(this.processor=setInterval((()=>{this.processQueue()}),this.processingInterval))}stop(){this.processor&&(clearInterval(this.processor),this.processor=null)}enqueue(e){0!==this.subscribers.length&&(this.queue.push({timestamp:Date.now(),data:e}),this.queue.length>this.maxSize&&this.queue.shift())}processQueue(){if(0===this.queue.length||0===this.subscribers.length)return;this.queue.splice(0,Math.min(10,this.queue.length)).forEach((({data:e})=>{this.subscribers.forEach((t=>t(e)))}))}subscribe(e){return this.subscribers.push(e),1!==this.subscribers.length||this.processor||this.start(),()=>{const t=this.subscribers.indexOf(e);t>-1&&this.subscribers.splice(t,1),0===this.subscribers.length&&this.stop()}}constructor(){this.queue=[],this.maxSize=1e3,this.processingInterval=100,this.processor=null,this.subscribers=[]}}}};